<!DOCTYPE html>
<html>
<head>
  <title>Deriv Authorization</title>
</head>
<body>
  <p>Authorizing...</p>
  <script>
    try {
      const url = new URL(window.location.href);
      const token1 = url.searchParams.get('token1');
      const token2 = url.searchParams.get('token2');
      const token = token1 || token2; // use whichever exists

      if (token) {
        // send the token to parent
        window.opener.postMessage(
          { type: 'deriv_auth', token },
          'https://tradealgopro.vercel.app' // you can tighten this later with your origin
        );
        window.close();
      } else {
        document.body.innerHTML = '<p>Authorization failed. Please try again.</p>';
      }
    } catch (err) {
      console.error('Auth error:', err);
      document.body.innerHTML = '<p>An error occurred during authorization.</p>';
    }
  </script>
</body>
</html>
